<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>빠던나인 게임진행</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="/css/common.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: relative;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .home-icon {
            color: #333;
            font-size: 24px;
            text-decoration: none;
            transition: color 0.3s;
        }

        .home-icon:hover {
            color: #007bff;
        }

        .page-title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 0;
        }

        .date-display {
            font-size: 18px;
            color: #666;
            padding: 8px 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }

        .game-selection {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .game-selection h2 {
            margin-bottom: 20px;
            color: #333;
            font-size: 20px;
        }

        .game-list {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            min-height: 100px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .error-message {
            text-align: center;
            padding: 20px;
            color: #dc3545;
            background-color: #f8d7da;
            border-radius: 5px;
            margin: 10px 0;
        }

        .no-games {
            text-align: center;
            padding: 20px;
            color: #666;
            background-color: #f8f9fa;
            border-radius: 5px;
            margin: 10px 0;
        }

        .game-item {
            flex: 1;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
        }

        .game-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-color: #007bff;
        }

        .game-item.selected {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }

        .team-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 5px;
        }

        .team-name {
            font-weight: 500;
        }

        .vs {
            color: #666;
            font-weight: bold;
        }

        .game-number {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .selected .vs,
        .selected .game-number {
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <div class="header">
            <div class="header-left">
                <a href="/index.html" class="home-icon">
                    <i class="fas fa-home"></i>
                </a>
            </div>
            <h1 class="page-title">빠던나인 게임진행</h1>
            <div class="date-display" id="dateDisplay"></div>
        </div>

        <!-- 경기 선택 -->
        <div class="game-selection">
            <h2>경기 선택</h2>
            <div class="game-list" id="gameList">
                <!-- 게임 목록이 여기에 동적으로 추가됩니다 -->
            </div>
        </div>
    </div>

    <script>
        // 현재 날짜 표시
        function updateDate() {
            const today = new Date();
            const dateStr = today.getFullYear() + '년 ' +
                           (today.getMonth() + 1) + '월 ' +
                           today.getDate() + '일';
            document.getElementById('dateDisplay').textContent = dateStr;
        }

        // 오늘의 경기 목록 가져오기
        async function fetchTodayGames() {
            const gameList = document.getElementById('gameList');
            gameList.innerHTML = '<div class="loading">경기 데이터를 불러오는 중...</div>';
            
            try {
                console.log('API 호출 시작: /api/game-progress/today-games');
                const response = await fetch('/api/game-progress/today-games');
                console.log('API 응답 받음:', response.status);
                
                const result = await response.json();
                console.log('서버 응답 데이터:', result);
                
                if (result.success) {
                    if (!result.games || result.games.length === 0) {
                        console.log('경기 데이터 없음');
                        gameList.innerHTML = '<div class="no-games">오늘의 경기 정보가 없습니다.</div>';
                        return;
                    }
                    
                    // 유효한 경기 데이터만 필터링
                    const validGames = result.games.filter(game => 
                        game.homeTeam && game.awayTeam && 
                        game.homeTeam.trim() !== '' && game.awayTeam.trim() !== ''
                    );
                    
                    console.log('유효한 경기 데이터:', validGames);
                    
                    if (validGames.length === 0) {
                        console.log('유효한 경기 데이터 없음');
                        gameList.innerHTML = '<div class="no-games">유효한 경기 정보가 없습니다.</div>';
                        return;
                    }
                    
                    gameList.innerHTML = '';
                    validGames.forEach((game, index) => {
                        const gameItem = document.createElement('div');
                        gameItem.className = 'game-item';
                        gameItem.innerHTML = `
                            <div class="team-info">
                                <span class="team-name">${game.homeTeam}</span>
                                <span class="vs">VS</span>
                                <span class="team-name">${game.awayTeam}</span>
                            </div>
                            <div class="game-number">${index + 1} 경기</div>
                        `;
                        
                        gameItem.addEventListener('click', () => {
                            document.querySelectorAll('.game-item').forEach(item => {
                                item.classList.remove('selected');
                            });
                            gameItem.classList.add('selected');
                        });
                        
                        gameList.appendChild(gameItem);
                    });
                    console.log('경기 목록 표시 완료');
                } else {
                    throw new Error(result.message || '경기 목록을 불러오는데 실패했습니다.');
                }
            } catch (error) {
                console.error('API 호출 에러:', error);
                gameList.innerHTML = `
                    <div class="error-message">
                        경기 목록을 불러오는데 실패했습니다.<br>
                        ${error.message}
                    </div>`;
            }
        }

        // 페이지 로드 시 실행
        window.onload = function() {
            console.log('페이지 로드됨');
            updateDate();
            fetchTodayGames();
        };
    </script>
</body>
</html> 